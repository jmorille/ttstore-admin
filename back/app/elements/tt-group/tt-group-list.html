<!-- -->
<link rel="import" href="../../components/polymer/polymer.html">


<link rel="import" href="../../components/core-field/core-field.html">

<link rel="import" href="../../components/paper-input/paper-input.html">
<link rel="import" href="../../components/paper-icon-button/paper-icon-button.html">


<link rel="import" href="tt-group-service.html">
<link rel="import" href="../tt-es-crud/tt-es-crud.html">

<polymer-element name="tt-group-list" attributes="">


    <template>

        <link rel="stylesheet" href="../../components/bootstrap/dist/css/bootstrap.css" shim-shadowdom>


        <tt-group-service id="service" entities="{{data}}"></tt-group-service>

        <section horizontal layout>
            <core-field>
                <paper-input placeHolder="Search Text" inputValue="{{searchText}}"
                             on-input="{{onSearchSuggest}}"></paper-input>
                <paper-icon-button icon="search" on-tap="{{searchReset}}"></paper-icon-button>
            </core-field>

        </section>


        <div class="table-responsive" style="background-color: white">
            <table class="table table-striped table-bordered table-hover">
                <thead>
                <th template repeat="{{col in entityColumns}}">
                    <td>
                        {{col}}
                    </td>
                </th>
                <th>Action</th>
                </thead>
                <tbody>
                <tr template repeat="{{item in data.hits.hits}}">
                    <td template repeat="{{col in entityColumns}}" on-click="{{entityEdit}}"
                        entity-id="{{item._id}}">
                        {{item._source[col]}}
                    </td>
                    <td>
                        <paper-icon-button icon="delete" entity-id="{{item._id}}"
                                           on-tap="{{entityDelete}}"></paper-icon-button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

    </template>

    <script>
        Polymer('tt-group-list', {

            data: undefined,
            searchOpt: undefined,

            created: function () {
                //   this.searchTest = '';
                this.entityColumns = ['firstname', 'lastname', 'email' ];
                this.searchOpt = {
                    "from": 0,
                    "size": 10,
                    "_source": ["firstname", "lastname", "email" ],
                    "sort": [  "lastname.raw:asc", "firstname.raw:asc" ]
                };

            },
            ready: function () {

            },
            search: function (optToSave) {
                var that = this;
                console.log("Search Service", this.$.service);
                this.$.service.entitySearch(this.searchOpt, function(err, resp){
                    console.log("Search Result");
                });
            },
            searchReset: function () {
                this.search({
                    from : 0
                });
            }

        });
    </script>
</polymer-element>