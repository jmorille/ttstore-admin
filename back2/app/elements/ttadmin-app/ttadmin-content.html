<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-right.html">

<link rel="import" href="ttadmin-notfound.html">
<link rel="import" href="ttadmin-page-portfolio.html">
<link rel="import" href="ttadmin-home.html">

<polymer-element name="ttadmin-content" attributes="selected">

  <template>

    <!-- Doc https://erikringsmuth.github.io/app-router/#/events#polymer-event-mapping-->
    <app-router mode="hash" on-activate-route-end="{{selectContentHandler}}" on-activate-route-start="{{activateRouteHandler}}"
                core-animated-pages transitions="slide-from-right cross-fade-all">

      <app-route path="/home" element="ttadmin-home"></app-route>
      <app-route path="/user"  element="admin-search"></app-route>
      <app-route path="/user/:entityid"  element="admin-user-edit"></app-route>

      <app-route path="/portfolio" element="ttadmin-page-portfolio"></app-route>
      <app-route path="/contact" element="yo-greeting"></app-route>

      <app-route path="/order/:orderId">
        <template>
          <p>Your order number is {{orderId}}</p>
        </template>
      </app-route>


      <app-route path="*" element="ttadmin-notfound"></app-route>

    </app-router>

  </template>
  <script>
    'use strict';
    Polymer('ttadmin-content', {

      activateRouteHandler: function (event, detail) {
        console.log('Activate Route Beding ', detail);
        this.selected = detail.path;
      },
      selectContentHandler: function (event, detail) {
        console.log('selectContentHandler event : ', event);
        console.log('selectContentHandler detail : ', detail);
        // New Route
        var item = detail.route;
        this.callNodesWithFunction(item, 'pageSelected');
        // Old Route
        if (detail.oldRoute) {
          this.async(function () {
              this.callNodesWithFunction(detail.oldRoute, 'pageUnselected');
            }
          );
        }
      },

      callNodesWithFunction: function (item, searchFunc) {
        var childNodes = item;
        if (!Array.isArray(childNodes)) {
          childNodes = childNodes.querySelectorAll('*');
        }
        if (childNodes) {
          Array.prototype.forEach.call(childNodes, function (childNode) {
            if (typeof childNode[searchFunc] === 'function') {
              childNode[searchFunc]();
            }
          });
        }
      }

    });

  </script>
</polymer-element>
