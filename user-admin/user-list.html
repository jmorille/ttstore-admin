<link rel="import" href="../components/polymer/polymer.html">

<link rel="import" href="../components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../components/paper-shadow/paper-shadow.html">

<link rel="import" href="user-service.html">
<link rel="import" href="user-service-mock.html">


<polymer-element name="user-list" attributes="data">

    <template>
        <link rel="stylesheet" href="../components/bootstrap/dist/css/bootstrap.css" shim-shadowdom>
        <style>
            :host {
                display: block;
            }


            /* Firefox has some awkward fieldset styling involving width that interferes with the responsive table. */
            @-moz-document url-prefix() {
                fieldset {
                    display: table-cell;
                }
            }

        </style>


        <div>
            <div>
                <paper-icon-button icon="add" on-tap="{{entityAdd}}"></paper-icon-button>

                <paper-icon-button icon="refresh" on-tap="{{refreshList}}"></paper-icon-button>
                <paper-shadow z="2"></paper-shadow>
            </div>



            <div class="table-responsive" style="background-color: white">
                <table class="table table-striped table-bordered table-hover">
                    <thead>
                    <template repeat="{{col in columns}}">
                        <th>{{col}}</th>
                    </template>
                    </thead>
                    <tbody>
                    <template repeat="{{item in data.hits}}">
                        <tr >
                            <template bind="{{item._source as it}}">
                                <template repeat="{{col in columns}}">
                                    <td on-click="{{entityEdit}}" entity-id="{{item._id}}">{{it[col]}}</td>
                                </template>
                                <td><paper-icon-button icon="delete" on-tap="{{test}}" ></paper-icon-button></td>
                           </template>
                        </tr>

                    </template>
                    </tbody>
                </table>
            </div>

            <paper-shadow z="2"></paper-shadow>
        </div>


    </template>
    <script>

        Polymer('user-list', {

            ready: function () {
                this.columns = ['firstname', 'lastname', 'email' ];
            },
            refreshList: function () {
                this.asyncFire('entity-search');
            },
            entityEdit: function (event, data, sender) {
                console.log("--- Click to Edit ");
                console.dir(data);
                console.dir(sender);
                var toEdit = sender.attributes['entity-id'].value;
                this.asyncFire('entity-edit', { _id: toEdit });
            },
            entityAdd: function () {
                console.log("--- Click to Add ");
                this.asyncFire('entity-add');

            },
            entityDelete: function (entityId) {
                this.asyncFire('entity-delete', { _id: toEdit._id });
            },
            test : function (e) {
                console.log("#######################################");
            }


        });

    </script>


</polymer-element>