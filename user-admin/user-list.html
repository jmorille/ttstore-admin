<link rel="import" href="../components/core-list/core-list.html">
<link rel="import" href="../components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="user-service.html">
<link rel="import" href="user-service-mock.html">


<polymer-element name="user-list" attributes="">
    <style>
        core-list {
            height: 100%;
        }


        .item {
            box-sizing: border-box;
            height: 80px;
            border-bottom: 1px solid #ddd;
            padding: 4px;
            cursor: default;
            background-color: white;
            overflow: hidden;
        }

        .selected {
            background: silver;
        }


    </style>

    <template>
        <user-service id="user_service" response="{{data}}"></user-service>


        <paper-icon-button icon="add" on-tap="{{entityAdd}}"></paper-icon-button>

        <paper-icon-button icon="refresh" on-tap="{{refreshList}}"></paper-icon-button>

        <core-list id="list" data="{{data}}"  on-core-activate="{{entityEdit}}">
            <template>
                <div class="item {{ {selected: selected} | tokenList }">
                    <span class="from">{{_source.firstname}}</span>
                    <span class="timestamp">{{_source.lastname}}</span>
                </div>
            </template>
        </core-list>


    </template>
    <script>

        Polymer('user-list', {

            data: undefined,
            ready: function () {

            },
            refreshList : function () {
                this.$.user_service.searchAll();
            },
            entityEdit : function(event) {
                var toEdit = event.detail.data;
                console.dir(toEdit);
                console.log("To Edit : " + toEdit._id);
                this.fire('entity-edit', { _id :  toEdit._id });
            },
            entityAdd : function() {
                this.fire('entity-add' );

            },
            entityDelete : function(entityId) {
                console.log("To Delete : " + entityId);
            }


        });

    </script>


</polymer-element>